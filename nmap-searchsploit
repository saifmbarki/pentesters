vues.py

# Loop through services and check for vulnerabilities using searchsploit
for host in nm.all_hosts():
    for port in nm[host]['tcp']:
        service = nm[host]['tcp'][port]['name']
        version = nm[host]['tcp'][port]['version']

        # Run searchsploit to check for vulnerabilities
        search_result = subprocess.check_output(['searchsploit', '-w', service, version], text=True)
        vuln = [line.strip() for line in search_result.split('\n') if line.strip()]  # Exclude empty strings

        # Parse vulnerabilities and exploits from searchsploit output
        vulnerabilities = []
        exploits = []
        for v in vuln:
            # Parse vulnerability ID and description
            try:
                vuln_id, vuln_desc = v.split(' ', 1)
            except ValueError:
                continue
            vulnerabilities.append((vuln_id, vuln_desc))

            # Parse exploits for vulnerability
            exploit_output = subprocess.check_output(['searchsploit', '-x', vuln_id], text=True)
            exploit = exploit_output.split('EDB-ID: ')[1].split(' ')[0].strip() if 'EDB-ID: ' in exploit_output else ''
            exploits.append(exploit)

        # Add vulnerabilities and exploits to results dictionary
        results.append({
            'host': host,
            'port': port,
            'service': service,
            'version': version,
            'vulnerabilities': vulnerabilities,
            'exploits': exploits
        })

# Pass results to template and render HTML
context = {'results': results}
template = loader.get_template('scans.html')
html = template.render(context)
return HttpResponse(html)
    
    
    ===================================================================================================================================
    scan.html
    
    
    
    
    {% if services %}
  <h2>Services</h2>
  <table>
    <thead>
      <tr>
        <th>Port</th>
        <th>Service</th>
        <th>Version</th>
      </tr>
    </thead>
    <tbody>
      {% for port, service, version in services %}
        <tr>
          <td>{{ port }}</td>
          <td>{{ service }}</td>
          <td>{{ version }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}

{% if vulnerabilities %}
  <h2>Vulnerabilities</h2>
  <table>
    <thead>
      <tr>
        <th>Service</th>
        <th>Exploits</th>
      </tr>
    </thead>
    <tbody>
      {% for vuln in vulnerabilities %}
        <tr>
          <td>{{ vuln.0 }}</td>
          <td>
            <ul>
              {% for exploit in vuln[1:] %}
                <li>{{ exploit }}</li>
              {% endfor %}
            </ul>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}

    
    
