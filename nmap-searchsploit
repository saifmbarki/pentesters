vues.py

import nmap
import subprocess
from django.http import HttpResponse
from django.template import loader

def scans(request):
    #target = request.GET.get('target', 'localhost')
    target = request.GET.get('target')
    
    if target is None:
        template = loader.get_template('scans.html')
        return HttpResponse(template.render())
        
    # Create Nmap scanner object
    nm = nmap.PortScanner()

    # Run Nmap scan on target
    nm.scan(target, arguments='-sV')

    # Extract (port, service, service version) information from Nmap scan results
    services = []
    vulnerabilities = []
    for host in nm.all_hosts():
        for port in nm[host]['tcp']:
            service = nm[host]['tcp'][port]['name']
            version = nm[host]['tcp'][port]['version']
            services.append((port, service, version))
            # Search for exploits using searchsploit
            output = subprocess.run(['searchsploit', f'{service} {version}'], capture_output=True, text=True)
            if output.stdout:
                vulnerabilities.append(output.stdout.strip().split('\n'))

    context = {
        'services': services,
        'vulnerabilities': vulnerabilities,
    }

    template = loader.get_template('scans.html')

    return HttpResponse(template.render(context, request))
    
    
    ===================================================================================================================================
    scan.html
    
    
    
    
    {% if services %}
  <h2>Services</h2>
  <table>
    <thead>
      <tr>
        <th>Port</th>
        <th>Service</th>
        <th>Version</th>
      </tr>
    </thead>
    <tbody>
      {% for port, service, version in services %}
        <tr>
          <td>{{ port }}</td>
          <td>{{ service }}</td>
          <td>{{ version }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}

{% if vulnerabilities %}
  <h2>Vulnerabilities</h2>
  <table>
    <thead>
      <tr>
        <th>Service</th>
        <th>Exploits</th>
      </tr>
    </thead>
    <tbody>
      {% for vuln in vulnerabilities %}
        <tr>
          <td>{{ vuln.0 }}</td>
          <td>
            <ul>
              {% for exploit in vuln[1:] %}
                <li>{{ exploit }}</li>
              {% endfor %}
            </ul>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}

    
    
